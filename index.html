<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MySchedule.AI | Absolute Organizer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8b5cf6;
            --accent: #d8b4fe;
            --bg: #030712;
        }

        body { 
            background-color: var(--bg);
            background-image: 
                radial-gradient(at 0% 0%, rgba(139, 92, 246, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(76, 29, 149, 0.15) 0px, transparent 50%);
            color: #f8fafc;
            font-family: 'Plus Jakarta Sans', sans-serif;
            overflow: hidden;
            height: 100vh;
        }

        .glass {
            background: rgba(255, 255, 255, 0.02);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        /* --- THE MECHANICAL SLOT PHYSICS --- */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(40px); filter: blur(10px); }
            to { opacity: 1; transform: translateY(0); filter: blur(0); }
        }

        #intro-view h1 {
            animation: fadeInUp 1.2s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        }

        .slot-window {
            height: 120px;
            overflow: hidden;
            display: inline-block;
            vertical-align: bottom;
            opacity: 0;
            animation: fadeInUp 1.2s cubic-bezier(0.22, 1, 0.36, 1) 0.4s forwards;
            mask-image: linear-gradient(to bottom, transparent, black 25%, black 75%, transparent);
        }
        
        .slot-reel {
            display: flex;
            flex-direction: column;
            animation: proSlotSpin 5s cubic-bezier(0.45, 0.05, 0.1, 1) forwards;
            animation-delay: 1.2s;
        }

        @keyframes proSlotSpin {
            0% { transform: translateY(0); filter: blur(0); }
            4% { transform: translateY(20px); } 
            25% { transform: translateY(-4000px); filter: blur(40px); }
            75% { transform: translateY(-8000px); filter: blur(10px); }
            92% { transform: translateY(-9030px); filter: blur(0); } 
            100% { transform: translateY(-9000px); filter: blur(0); }
        }

        .slot-item {
            height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            font-weight: 800;
            letter-spacing: -0.05em;
            text-transform: uppercase;
        }

        .perfection-text {
            color: #c084fc; 
            text-shadow: 0 0 20px rgba(168, 85, 247, 0.8), 0 0 40px rgba(168, 85, 247, 0.4);
            font-weight: 900;
        }

        .hidden-locked { 
            opacity: 0; 
            pointer-events: none; 
            transform: translateY(30px) scale(0.95); 
            transition: all 1.2s cubic-bezier(0.34, 1.56, 0.64, 1); 
        }

        .unlocked { 
            opacity: 1; 
            pointer-events: auto; 
            transform: translateY(0) scale(1); 
        }

        #enter-btn:hover {
            letter-spacing: 0.4em;
            background: #fff;
            color: #000;
            box-shadow: 0 0 50px rgba(139, 92, 246, 0.5);
        }

        .view { display: none; width: 100%; height: 100%; opacity: 0; transition: transform 0.8s cubic-bezier(0.22, 1, 0.36, 1), opacity 0.8s ease; }
        .view.active { display: flex; opacity: 1; }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: 80px repeat(5, 1fr);
            grid-template-rows: 50px repeat(24, 1fr);
            height: 100%;
            overflow-y: auto;
            scrollbar-width: none;
        }

        .calendar-grid::-webkit-scrollbar { display: none; }

        .cell { 
            border: 1px solid rgba(255,255,255,0.03); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            position: relative;
            transition: background 0.2s ease;
        }
        .cell:not(.cell-header):not(.time-col):hover {
            background: rgba(255,255,255,0.02);
        }

        .cell-header { font-size: 11px; font-weight: 800; color: var(--accent); background: rgba(139,92,246,0.05); text-transform: uppercase; letter-spacing: 0.1em; position: sticky; top: 0; z-index: 20; backdrop-filter: blur(10px); }
        .time-col { font-size: 10px; font-weight: 800; color: #475569; font-variant-numeric: tabular-nums; }
        
        .event-node {
            position: absolute;
            inset: 4px;
            background: linear-gradient(135deg, #7c3aed, #4c1d95);
            border-left: 3px solid #fff;
            border-radius: 8px;
            padding: 8px;
            font-size: 11px;
            font-weight: 700;
            color: white;
            z-index: 10;
            text-align: center;
            animation: nodePop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        @keyframes nodePop { from { opacity: 0; transform: scale(0.5); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body class="flex flex-col">

    <header class="w-full py-6 px-12 glass flex justify-between items-center z-50 border-b border-white/5">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center font-black">MS</div>
            <div class="text-2xl font-black tracking-tighter uppercase">MySchedule.AI</div>
        </div>
        <div id="status-chip" class="px-4 py-1.5 rounded-full bg-white/5 border border-white/10 text-[10px] font-bold text-slate-400 uppercase tracking-widest transition-all">
            System: Booting
        </div>
    </header>

    <main class="flex-1 relative">
        <section id="intro-view" class="view active flex-col items-center justify-center text-center p-6">
            <div class="mb-12">
                <h1 class="text-7xl font-light text-white mb-2 tracking-tight">Your week, <br><strong>Perfectly Synced.</strong></h1>
            </div>

            <div class="mb-20">
                <div class="slot-window">
                    <div class="slot-reel" id="reel-container"></div>
                </div>
            </div>

            <button id="enter-btn" onclick="transitionView('app')" class="hidden-locked bg-white text-black px-16 py-6 rounded-2xl font-black text-sm uppercase tracking-[0.3em] transition-all">
                Enter Dashboard
            </button>
        </section>

        <section id="app-view" class="view p-8 gap-8">
            <div class="w-1/4 glass rounded-[3rem] p-10 flex flex-col gap-6 border border-white/5">
                <h3 class="text-xs font-black text-slate-500 uppercase tracking-widest">Natural Intelligence</h3>
                <textarea id="userInput" class="flex-1 bg-black/40 border border-white/5 rounded-3xl p-6 text-sm text-white outline-none focus:border-purple-500/30 transition-all resize-none" placeholder="E.g. 'Gym at 06:00, meeting at 14:00, sleep at 23:00...'"></textarea>
                <div class="flex flex-col gap-3">
                    <button id="syncBtn" class="w-full bg-purple-600 py-6 rounded-3xl font-black uppercase text-xs shadow-xl hover:bg-purple-500 transition-all active:scale-95">Sync Schedule</button>
                    <button onclick="clearSchedule()" class="text-[10px] text-slate-500 uppercase font-bold hover:text-white transition-all">Reset Framework</button>
                </div>
            </div>
            <div class="flex-1 glass rounded-[3rem] p-10 flex flex-col border border-white/5 overflow-hidden">
                <div id="calendar" class="calendar-grid flex-1 rounded-2xl"></div>
            </div>
        </section>
    </main>

    <script>
        const GROQ_KEY = "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";
        const MODEL = "llama-3.3-70b-versatile";

        // Initialization Logic
        window.onload = () => {
            initReel();
            initCalendar();
            
            setTimeout(() => {
                document.getElementById('enter-btn').classList.add('unlocked');
                updateStatus("System: Ready", "green");
                loadLocalData();
            }, 6400);

            // Listener for 'Cmd+Enter' or 'Ctrl+Enter' to sync quickly
            document.getElementById('userInput').addEventListener('keydown', (e) => {
                if ((e.metaKey || e.ctrlKey) && e.key === 'Enter') syncSchedule();
            });
        };

        function initReel() {
            const reel = document.getElementById('reel-container');
            const items = ["Analyze", "Optimize", "Sync", "PERFECTION"];
            let content = "";
            for(let i=0; i<18; i++) { 
                items.forEach(text => {
                    const isPerf = text === "PERFECTION";
                    content += `<div class="slot-item ${isPerf ? 'perfection-text' : 'text-slate-700'}">${text}${isPerf?'.':''}</div>`;
                });
            }
            // Add items to reach target index 75
            content += `<div class="slot-item text-slate-700">Analyze</div>`;
            content += `<div class="slot-item text-slate-700">Optimize</div>`;
            content += `<div class="slot-item text-slate-700">Sync</div>`;
            content += `<div class="slot-item perfection-text">PERFECTION.</div>`;
            reel.innerHTML = content;
        }

        function initCalendar() {
            const cal = document.getElementById('calendar');
            const cols = ['Time', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri'];
            cal.innerHTML = cols.map(c => `<div class="cell cell-header">${c}</div>`).join('');
            
            for (let h = 0; h < 24; h++) {
                const timeString = h.toString().padStart(2, '0') + ':00';
                cal.innerHTML += `<div class="cell time-col">${timeString}</div>`;
                for (let d = 0; d < 5; d++) {
                    cal.innerHTML += `<div class="cell" id="slot-${h}-${d}"></div>`;
                }
            }
        }

        async function syncSchedule() {
            const txt = document.getElementById('userInput').value;
            if(!txt) return;
            updateStatus("System: Syncing...", "purple");

            try {
                const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${GROQ_KEY}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: MODEL,
                        messages: [
                            { role: "system", content: "Return ONLY JSON. Key: 'schedule'. Each object must have: 'hour' (0-23), 'dayIndex' (0-4), 'task' (string). Correctly interpret 24hr and 12hr time." },
                            { role: "user", content: txt }
                        ],
                        response_format: { type: "json_object" }
                    })
                });
                const data = await response.json();
                const content = JSON.parse(data.choices[0].message.content);
                renderSchedule(content.schedule || []);
                saveLocalData(content.schedule || []);
                updateStatus("System: Optimized", "green");
            } catch (err) { 
                updateStatus("System: Error", "red");
                console.error("Sync Error:", err); 
            }
        }

        document.getElementById('syncBtn').onclick = syncSchedule;

        function renderSchedule(tasks) {
            document.querySelectorAll('.event-node').forEach(el => el.remove());
            tasks.forEach(item => {
                const container = document.getElementById(`slot-${item.hour}-${item.dayIndex}`);
                if (container) {
                    container.innerHTML = `<div class="event-node" title="${item.task}">${item.task}</div>`;
                }
            });
        }

        function updateStatus(text, color) {
            const chip = document.getElementById('status-chip');
            chip.innerText = text;
            chip.className = `px-4 py-1.5 rounded-full border text-[10px] font-bold uppercase tracking-widest transition-all `;
            
            if(color === "green") chip.classList.add('text-green-400', 'border-green-500/20', 'bg-green-500/5');
            else if(color === "purple") chip.classList.add('text-purple-400', 'border-purple-500/20', 'bg-purple-500/5');
            else if(color === "red") chip.classList.add('text-red-400', 'border-red-500/20', 'bg-red-500/5');
            else chip.classList.add('text-slate-400', 'border-white/10', 'bg-white/5');
        }

        function transitionView(v) {
            const cur = document.querySelector('.view.active');
            const next = document.getElementById(v + '-view');
            cur.style.transform = "translateY(-30px) scale(0.95)";
            cur.style.opacity = "0";
            setTimeout(() => {
                cur.classList.remove('active');
                next.classList.add('active');
                setTimeout(() => {
                    next.style.opacity = "1";
                    next.style.transform = "translateY(0) scale(1)";
                }, 50);
            }, 800);
        }

        function saveLocalData(d) { localStorage.setItem('myschedule_ai_backup', JSON.stringify(d)); }
        function loadLocalData() {
            const b = localStorage.getItem('myschedule_ai_backup');
            if (b) renderSchedule(JSON.parse(b));
        }
        function clearSchedule() {
            if(confirm("Wipe this week's AI logic?")) {
                localStorage.removeItem('myschedule_ai_backup');
                document.querySelectorAll('.event-node').forEach(el => el.remove());
                document.getElementById('userInput').value = "";
                updateStatus("System: Cleared", "slate");
            }
        }
    </script>
</body>
</html>